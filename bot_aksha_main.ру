import os
import telebot
import requests

# –ë–µ—Ä–µ–º —Ç–æ–∫–µ–Ω –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫ Render
TOKEN = os.getenv("BOT_TOKEN")
bot = telebot.TeleBot(TOKEN)

def get_rate():
    """–ü–æ–ª—É—á–∞–µ—Ç —Å–≤–µ–∂–∏–π –∫—É—Ä—Å USD/KZT"""
    try:
        url = "https://api.exchangerate-api.com/v4/latest/USD"
        data = requests.get(url).json()
        return data['rates']['KZT']
    except:
        return "–Ω–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å"

@bot.message_handler(commands=['start'])
def start(message):
    rate = get_rate()
    text = (
        f"üá∞üáø *–ö—É—Ä—Å USD/KZT:*\n"
        f"üíµ 1$ = *{rate}* —Ç–µ–Ω–≥–µ\n\n"
        f"üìä –ê–Ω–∞–ª–∏–∑: –†—ã–Ω–æ–∫ —Å—Ç–∞–±–∏–ª–µ–Ω. –°–∏–ª—å–Ω—ã—Ö —Å–∫–∞—á–∫–æ–≤ –ø–æ–∫–∞ –Ω–µ –≤–∏–¥–Ω–æ."
    )
    bot.send_message(message.chat.id, text, parse_mode="Markdown")

# –ó–∞–ø—É—Å–∫
print("–ë–æ—Ç –ø—Ä–æ—Å–Ω—É–ª—Å—è –∏ –≥–æ—Ç–æ–≤ –∫ –∞–Ω–∞–ª–∏—Ç–∏–∫–µ...")
bot.polling(non_stop=True)
